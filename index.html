<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Advance Valves – Quotation Calculator | Vijay Sales Corporation</title>

<style>
  :root{ --brand:#24364e; }
  body{font-family:Arial,Helvetica,sans-serif;background:#f7f8fb;color:#333;margin:0}
  header{background:var(--brand);color:#fff;padding:10px 14px;text-align:center;font-weight:bold}
  main{max-width:980px;margin:24px auto;padding:0 16px}
  h1{color:var(--brand);margin:6px 0 14px}

  .card{background:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.06);padding:16px;margin:14px 0;width:100%;display:block}
  label{display:block;margin:10px 0 6px;font-weight:600}
  select,input{width:100%;padding:10px;border:1px solid #ccd1d9;border-radius:6px;background:#fff;min-height:44px}

  .row{display:grid;gap:12px}
  @media(min-width:720px){
    .row.cols-2{grid-template-columns:1fr 1fr}
    .row.cols-3{grid-template-columns:1fr 1fr 1fr}
    .row.cols-4{grid-template-columns:1fr 1fr 1fr 1fr}
  }

  .btn{background:var(--brand);color:#fff;border:none;border-radius:8px;padding:10px 16px;font-weight:700;cursor:pointer}
  .btn.secondary{background:#fff;color:var(--brand);border:2px solid var(--brand)}
  .btn:disabled{opacity:.6;cursor:not-allowed}

  /* Desktop table */
  table{width:100%;border-collapse:collapse;margin-top:10px}
  #quoteTable{width:100%;table-layout:auto;min-width:760px}
  th,td{border:1px solid #e3e6eb;padding:10px;text-align:center}
  th{background:var(--brand);color:#fff}
  tfoot td{font-weight:700}

  .flex{display:flex;gap:10px;flex-wrap:wrap}
  .right{justify-content:flex-end}
  .muted{color:#666;font-size:12px}

  /* Helpers + ensure full-row placement */
  .table-responsive{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}
  .divider{border:0;border-top:1px solid #e3e6eb;margin:16px 0}
  .powered-by{display:block;width:100%;text-align:center;margin:16px 0 0;clear:both;color:#555;font-size:14px}

  /* Force table, divider & buttons to sit UNDER each other even inside grids */
  .card .table-responsive,
  .card .divider,
  .card .flex.right{grid-column:1 / -1; width:100%; float:none; clear:both; display:block}
  .card .flex.right{display:flex; justify-content:flex-end; gap:10px; flex-wrap:wrap; margin-top:14px}

  /* =======================
     Mobile: 2-column card view
     ======================= */
  @media (max-width:640px){
    main{padding:0 12px}
    h1{font-size:clamp(20px,5.5vw,26px)}
    label{font-size:14px}
    th,td{padding:8px 6px;font-size:13px}

    /* turn table rows into cards (no horizontal scroll) */
    #quoteTable{min-width:0; border-collapse:separate; border-spacing:0 12px}
    #quoteTable thead{display:none}

    #quoteTable tbody tr{
      display:grid;
      grid-template-columns: 1fr 1fr; /* label | value */
      gap:8px;
      background:#fff;
      border:1px solid #e3e6eb;
      border-radius:8px;
      padding:12px;
    }
    #quoteTable tbody td{
      border:none;
      padding:0;
      font-size:14px;
      text-align:left;
      background:#fff;
    }

    /* Auto labels (match your exact column order) */
    #quoteTable tbody td:nth-child(1)::before{content:"Product: ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(2)::before{content:"Size (NB): ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(3)::before{content:"Operation: ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(4)::before{content:"Unit Price (₹): ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(5)::before{content:"Qty: ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(6)::before{content:"Line Total (₹): ";font-weight:700;color:#667085;display:block;margin-bottom:2px}
    #quoteTable tbody td:nth-child(7)::before{content:"Remove: ";font-weight:700;color:#667085;display:block;margin-bottom:2px}

    /* Put the Remove button on its own row, right aligned */
    #quoteTable tbody td:nth-child(7){
      grid-column:1 / -1;
      justify-self:end;
    }

    /* totals -> compact cards */
    #quoteTable tfoot tr{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:8px;
      background:#fff;
      border:1px solid #e3e6eb;
      border-radius:8px;
      padding:12px;
    }
    #quoteTable tfoot td{border:none;padding:0;font-size:14px;text-align:left}
    #quoteTable tfoot td[colspan]{grid-column:1;text-align:left}
    #quoteTable tfoot td[id]{grid-column:2;text-align:right}
    #quoteTable tfoot td:last-child{display:none}

    /* Buttons full-width under the table */
    .row{grid-template-columns:1fr !important}
    .card .flex.right{justify-content:stretch; flex-direction:column}
    .card .flex.right .btn{width:100%}

    .powered-by{font-size:13px;margin:12px 0 0}
  }
</style>



<!-- jsPDF + AutoTable for PDF -->
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
<header>
  Vijay Sales Corporation • sales@vijaysalescorp.com • +91 9999889008
</header>

<main>
  <h1>Advance Valves – Price & Quotation Calculator</h1>

  <div class="card">
    <div class="row cols-4">
      <div>
        <label for="category">Product</label>
        <select id="category"></select>
      </div>
      <div>
        <label for="size">Size (NB)</label>
        <select id="size"></select>
      </div>
      <div id="opWrap" style="display:none">
        <label for="operation">Operation</label>
        <select id="operation"></select>
      </div>
      <div>
        <label for="qty">Quantity (pcs)</label>
        <input type="number" id="qty" value="1" min="1"/>
      </div>
    </div>

    
        <label for="unitPrice">Price / pc (₹)</label>
        <input type="text" id="unitPrice" readonly/>
      </div>
      <div>
        <label for="discount">Discount (%)</label>
        <input type="number" id="discount" value="25" readonly />
      </div>
      <div>
        <label>&nbsp;</label>
        <button class="btn" onclick="addItem()">Add to Quotation</button>
      </div>
      <div>
        </div> 
        
    

  <div class="card">
    <h2 style="margin:0 0 10px">Quotation Summary</h2>
    <table id="quoteTable">
      <thead>
        <tr>
          <th>Product</th>
          <th>Size (NB)</th>
          <th>Operation</th>
          <th>Unit Price (₹)</th>
          <th>Qty</th>
          <th>Line Total (₹)</th>
          <th>Remove</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
  <tr>
    <td colspan="5" style="text-align:right">Sub-Total</td>
    <td id="subTotal">₹0</td>
    <td></td>
  </tr>
  <tr>
    <td colspan="5" style="text-align:right">GST (18%)</td>
    <td id="gstAmt">₹0</td>
    <td></td>
  </tr>
  <tr>
    <td colspan="5" style="text-align:right"><strong>Grand Total</strong></td>
    <td id="grandTotal">₹0</td>
    <td></td>
  </tr>
</tfoot>

    </table>
    
</div>
<hr class="divider">

    <div class="flex right" style="margin-top:14px">
      <button class="btn" onclick="downloadPDF()">Download PDF</button>
      <button class="btn secondary" onclick="sendWA()">Send via WhatsApp</button>
      <button class="btn secondary" onclick="resetAll()">Reset</button>
    </div>
  </div>
<p class="powered-by">
  ⚡ Powered by <strong>Vijay Sales Corporation</strong> – India’s Piping Experts since 1961.
</p>



</main>

<script>
/* ---- PRICE DATA (₹/pc) — from your uploaded PDF ---- */
const ADV_DATA = {
  "Butterfly Valve PN1.0": {
    prices: { "50":2466, "65":2653, "80":2840, "100":3714, "125":4495, "150":5181, "200":11766 },
    operationBySize: { "50":"Lever","65":"Lever","80":"Lever","100":"Lever","125":"Lever","150":"Lever","200":"Gear" }
  },
  "Butterfly Valve PN16": {
    prices: { "50":2716,"65":2934,"80":3090,"100":4089,"125":4932,"150":5681,"200":12965,"250":19102,"300":26344 },
    operationBySize: { "50":"Lever","65":"Lever","80":"Lever","100":"Lever","125":"Lever","150":"Lever","200":"Lever","250":"Gear","300":"Gear" }
  },
  "Butterfly Valve PN16 (SS-410 Disc)": {
    prices: { "50":2934,"65":3090,"80":3371,"100":4557,"125":5681,"150":6555,"200":11145,"200-Gear":14585,"250-Gear":23597,"300-Gear":33211,"350-Gear":50940 },
    // special handling: 200 has both Lever & Gear; 250/300/350 are Gear only; others assumed Lever
    operationBySize: {} // will be computed dynamically below
  
  },
  "Dual Plate NRV PN16": {
    prices: { "50":2310,"65":2622,"80":3184,"100":4620,"125":6680,"150":8178,"200":14483,"250":21849,"300":34709 },
    operationBySize: {}
  },
  "Bronze Balancing Valve (Threaded)": {
    prices: { "25":4370,"32":6555,"40":7304,"50":10675 },
    operationBySize: {}
  },
  "CI Balancing Valve (Flanged End)": {
    prices: { "65":11549,"80":13172,"100":18978,"125":26094,"150":34834,"200":68544,"250":128598,"300":167302 },
    operationBySize: {}
  }
};

// Build operationBySize for the SS-410 group (to support 200 Lever/Gear)
(function(){
  const op = {};
  Object.keys(ADV_DATA["Butterfly Valve PN16 (SS-410 Disc)"].prices).forEach(k=>{
    if(k==="200") op["200"]="Lever";
    else if(k==="200-Gear") op["200-Gear"]="Gear";
    else if(k.endsWith("-Gear")) op[k]="Gear";
    else op[k]="Lever";
  });
  ADV_DATA["Butterfly Valve PN16 (SS-410 Disc)"].operationBySize = op;
})();

/* ---- UI elements ---- */
const $cat = document.getElementById('category');
const $size = document.getElementById('size');
const $opWrap = document.getElementById('opWrap');
const $op = document.getElementById('operation');
const $qty = document.getElementById('qty');
const $unit = document.getElementById('unitPrice');
const $tbody = document.querySelector('#quoteTable tbody');
const $sub   = document.getElementById('subTotal');
const $gstAmt= document.getElementById('gstAmt');
const $grand = document.getElementById('grandTotal');


let rows = [];

/* ---- populate Category ---- */
(function init(){
  Object.keys(ADV_DATA).forEach(k=>{
    const opt = document.createElement('option');
    opt.value = k; opt.textContent = k;
    $cat.appendChild(opt);
  });
  onCategory();
})();

$cat.addEventListener('change', onCategory);
$size.addEventListener('change', onSize);
$op.addEventListener('change', updateUnitPrice);

function onCategory(){
  $size.innerHTML = '';
  $op.innerHTML = '';
  $opWrap.style.display = 'none';

  const group = ADV_DATA[$cat.value];
  const sizes = Object.keys(group.prices)
    .map(s=>s) // keep special keys like '200-Gear'
    .filter(s=>!s.includes('-Gear')) // default list shows numeric sizes
    .sort((a,b)=>parseInt(a)-parseInt(b));

  // For SS-410 group, also ensure 200 is in list (lever shown as 200; gear handled via op dropdown)
  sizes.forEach(s=>{
    const o = document.createElement('option');
    o.value = s; o.textContent = s;
    $size.appendChild(o);
  });
  if(sizes.length){ $size.value = sizes[0]; }

  onSize();
}

function onSize(){
  const cat = $cat.value;
  const size = $size.value;

  // Decide if operation dropdown is needed
  let ops = [];
  if(cat==="Butterfly Valve PN16 (SS-410 Disc)"){
    if(size==="200"){ ops = ["Lever","Gear"]; }
    else if(["250","300","350"].includes(size)){ ops = ["Gear"]; }
    else { ops = ["Lever"]; }
  } else if(cat==="Butterfly Valve PN1.0"){
    ops = (size==="200")?["Gear"]:["Lever"];
  } else if(cat==="Butterfly Valve PN16"){
    if(["250","300"].includes(size)) ops=["Gear"]; else ops=["Lever"];
  }

  if(ops.length){
    $opWrap.style.display = '';
    $op.innerHTML = '';
    ops.forEach(v=>{
      const o = document.createElement('option');
      o.value = v; o.textContent = v;
      $op.appendChild(o);
    });
  } else {
    $opWrap.style.display = 'none';
    $op.innerHTML = '';
  }
  updateUnitPrice();
}

function updateUnitPrice(){
  const cat = $cat.value;
  let sizeKey = $size.value;

  // Handle special price keys for SS-410 Gear on 200, 250, 300, 350
  if(cat==="Butterfly Valve PN16 (SS-410 Disc)"){
    const op = ($opWrap.style.display!=='none') ? $op.value : 'Lever';
    if(op==="Gear" && (sizeKey==="200"||sizeKey==="250"||sizeKey==="300"||sizeKey==="350")){
      if(sizeKey==="200") sizeKey = "200-Gear";
      else sizeKey = sizeKey+"-Gear";
    }
  }

  const price = ADV_DATA[cat].prices[sizeKey];
  $unit.value = price ? price.toLocaleString('en-IN') : '';
}

function addItem(){
  const cat = $cat.value;
  let size = $size.value;
  const qty = Math.max(1, parseInt($qty.value||'1',10));
  const op = ($opWrap.style.display!=='none') ? $op.value : '';
  let sizeKey = size;

  if(cat==="Butterfly Valve PN16 (SS-410 Disc)" && op==="Gear"){
    if(size==="200") sizeKey="200-Gear"; else sizeKey = size+"-Gear";
  }

  const unit = ADV_DATA[cat].prices[sizeKey];
  if(!unit) return alert('Invalid selection');

  const discountPct = 25; // fixed discount
  const unitAfterDisc = unit * (1 - discountPct/100);
  const line = unitAfterDisc * qty;

  const row = {cat, size, op, unit, discountPct, qty, total: line};
  rows.push(row);
  renderRows();
  // reset qty only
  $qty.value = 1;
}

function renderRows(){
  $tbody.innerHTML = '';
  rows.forEach((r,idx)=>{
    const tr = document.createElement('tr');
   tr.innerHTML = `
  <td data-label="Product">${r.cat}</td>
  <td data-label="Size (NB)">${r.size}</td>
  <td data-label="Operation">${r.op || '-'}</td>
  <td data-label="Unit Price (₹)">₹${(r.unit*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})}</td>
  <td data-label="Qty">${r.qty}</td>
  <td data-label="Line Total (₹)">₹${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}</td>
  <td data-label="Remove"><button class="btn secondary" onclick="removeRow(${idx})">X</button></td>
`;

    $tbody.appendChild(tr);
  });
  recalc();
}

function removeRow(i){
  rows.splice(i,1);
  renderRows();
}

function recalc(){
  const sub   = rows.reduce((a,b)=>a + b.total, 0);
  const gst   = +(sub * 0.18).toFixed(2);  // fixed 18%
  const grand = sub + gst;

  $sub.textContent    = "₹" + sub.toLocaleString('en-IN',{maximumFractionDigits:2});
  $gstAmt.textContent = "₹" + gst.toLocaleString('en-IN',{maximumFractionDigits:2});
  $grand.textContent  = "₹" + grand.toLocaleString('en-IN',{maximumFractionDigits:2});
}


function resetAll(){
  rows = [];
  renderRows();
  document.getElementById('discount').value = 25;
  recalc();
}

/* ---- PDF ---- */
function downloadPDF(){
  recalc();
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFontSize(14);
  doc.text('Advance Valves – Quotation', 14, 14);
  doc.setFontSize(10);
  doc.text('Vijay Sales Corporation • sales@vijaysalescorp.com • +91 9999889008',14,20);

  const body = rows.length? rows.map(r=>[
    r.cat, r.size, (r.op||'-'),
    `INR ${(r.unit*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})}`,
    r.qty, `INR ${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}`
  ]) : [['-','-','-','-','-','-']];

  doc.autoTable({
    startY: 26,
    head: [['Product','Size (NB)','Operation','Unit (INR)','Qty','Line Total (INR)']],
    body
  });

 const y = (doc.lastAutoTable?.finalY || 26) + 8;
const sub   = rows.reduce((a,b)=>a+b.total, 0);
const gst   = +(sub * 0.18).toFixed(2);
const grand = sub + gst;

doc.setFontSize(11);
doc.text(`Sub-Total: INR ${sub.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y);
doc.text(`GST (18%): INR ${gst.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y+6);
doc.setFont(undefined,'bold');
doc.text(`Grand Total: INR ${grand.toLocaleString('en-IN',{maximumFractionDigits:2})}`, 14, y+14);
doc.setFont(undefined,'normal');
doc.setFontSize(9);
doc.text('Notes: Rates are EX Delhi; Cartage & Freight shall be extra as per actual.', 14, y+22);

doc.save('Advance-Valves-Quotation.pdf');

}

/* ---- WhatsApp ---- */
function sendWA(){
  recalc();
  let msg = 'Advance Valves Quotation – Vijay Sales Corporation\n\n';
  if(!rows.length){ msg += '(No items added)\n'; }
  rows.forEach(r=>{
    msg += `• ${r.cat} | ${r.size} NB ${r.op? '| '+r.op : ''} | Qty ${r.qty} | Unit ₹${(r.unit*(1-r.discountPct/100)).toLocaleString('en-IN',{maximumFractionDigits:2})} | Line ₹${r.total.toLocaleString('en-IN',{maximumFractionDigits:2})}\n`;
  });
  const sub   = rows.reduce((a,b)=>a+b.total, 0);
const gst   = +(sub * 0.18).toFixed(2);
const grand = sub + gst;

msg += `\nSub-Total: ₹${sub.toLocaleString('en-IN',{maximumFractionDigits:2})}`;
msg += `\nGST (18%): ₹${gst.toLocaleString('en-IN',{maximumFractionDigits:2})}`;
msg += `\nGrand Total: ₹${grand.toLocaleString('en-IN',{maximumFractionDigits:2})}\n\n`;
msg += `Contact: 9999889008 • sales@vijaysalescorp.com`;

const url = `https://wa.me/919999889008?text=${encodeURIComponent(msg)}`;
window.open(url,'_blank');

}
</script>
</body>
</html>
